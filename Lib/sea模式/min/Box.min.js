// BoxJS框架
define(function(require,exports,module){var fl=require("./fl.min.js");var Box=function(d,c){this.setting={obj:d,objparent:""||d.parentNode};this.selectEvent=null;this.move=true;this.title=false;if(!Box.prototype.BG){var b=document.getElementsByTagName("body")[0];var a=document.createElement("a");fl.addClass(a,"createBoxBG");fl.attr(a,"href","javascript:");a.id="createBG";b.appendChild(a);Box.prototype.BG=a}};Box.prototype.select=function(b,a,c){var d=this;fl.unbind(d.setting.obj,b,d.selectEvent);fl.bind(this.setting.obj,b,this.selectEvent=function(p){p.preventDefault();fl.addClass(Box.prototype.BG,"BGhover");var l=document.createElement("ul");l.id="createBox";fl.addClass(l,"createBoxSelect");for(var k=0;k<a.length;k++){if(a[k]["title"]){d.title=true;for(var h=0;h<a[k]["title"].length;h++){var e=document.createElement("li");fl.addClass(e,"createBoxName");e.innerHTML="<span>"+a[k]["title"][h]["key"]+"</span>";fl.attr(e,"optValue",a[k]["title"][h]["value"]);l.appendChild(e)}}if(a[k]["list"]){for(var h=0;h<a[k]["list"].length;h++){var n=document.createElement("li");
var g=document.createElement("a");fl.addClass(g,"createBoxLi");g.innerHTML=a[k]["list"][h]["value"];fl.attr(g,"href","javascript:");fl.attr(g,"optValue",a[k]["list"][h]["key"]);n.appendChild(g);l.appendChild(n)}}}d.setting.objparent.appendChild(l);if(d.move){var m=0;var f=null;var o=document.body.scrollTop;f=setInterval(function(){document.body.scrollTop=m+o;m+=10;if(m+o>=d.setting.objparent.offsetTop-60){clearInterval(f)}},13)}fl.bind(document,"click",d.callback=function(j){var j=j||event;if(j.target.className=="createBoxLi"){if(d.setting.obj.nodeName=="INPUT"){d.setting.obj.value=j.target.innerHTML}else{console.log(typeof d.setting.obj);d.setting.obj.innerHTML='<div class="selectBox done"><div class="st"></div>'+j.target.innerHTML+"</div>"}d.setting.objparent.removeChild(l);fl.removeClass(Box.prototype.BG,"BGhover");fl.unbind(document,"click",d.callback);fl.bind(d.setting.obj,b,d.selectEvent);if(d.title){var i=fl.prev(j.target.parentNode);while(i.className!="createBoxName"){i=fl.prev(i)
}c&&c.call(d,fl.attr(i,"optValue"),fl.attr(j.target,"optValue"))}else{c&&c.call(d,fl.attr(j.target,"optValue"))}}else{if(j.target.id=="createBG"){d.setting.objparent.removeChild(l);fl.removeClass(Box.prototype.BG,"BGhover");fl.unbind(document,"click",d.callback)}}})})};Box.prototype.unSelect=function(a,b){fl.unbind(this.setting.obj,a,this.selectEvent);this.setting.obj.innerHTML='<div class="selectBox"><div class="st"></div>'+b+"</div>"};Box.prototype.alertBox=function(b,f,d,c){var e=this;var a=true;fl.unbind(e.setting.obj,b,e.alertEvent);fl.bind(this.setting.obj,b,this.alertEvent=function(g){if(a){Box.prototype.BG.style.visibility="visible";Box.prototype.BG.style.opacity="0.8";d&&d.call(e.setting.obj)}else{c&&c.call(e.setting.obj)}a=!a;fl.bind(document,"click",e.alertback=function(h){var h=h||event;if(h.target.id=="createBG"||fl.attr(h.target,"type")==f){e.closeBG();fl.unbind(document,"click",e.alertback);c&&c.call(e.setting.obj);a=!a}})})};Box.prototype.closeBG=function(){Box.prototype.BG.style.opacity="0";
setTimeout(function(){Box.prototype.BG.style.visibility="hidden"},500)};Box.prototype.alertLine=function(b,g){fl.addClass(Box.prototype.BG,"BGhover");Box.prototype.BG.style.zIndex="999";var a=document.getElementsByTagName("body")[0];var c=document.createElement("div");var e=document.createElement("p");var d=document.createElement("div");e.innerHTML=b;d.innerHTML=g;d.id="closeBut";fl.addClass(c,"alertstyle");c.appendChild(e);c.appendChild(d);a.appendChild(c);var f=this;fl.bind(c,"click",f.alertLineback=function(h){var h=h||event;h.stopPropagation();if(h.target.id=="closeBut"){fl.unbind(c,"click",f.alertLineback);f.closeBG();a.removeChild(c);Box.prototype.BG.style.zIndex="50"}})};module.exports = Box;})